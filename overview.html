<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>What's Going ON Here? - Overview</title>
  <link rel="stylesheet" href="overview.css">
</head>
<body>
  <div class="main-content">
    <div id="statusMessage" class="status-message"></div>
    <div class="section-title activity-title">
      Activity Overview
      <button class="settings-btn" id="toggleSettings">Settings</button>
    </div>
    <div id="overviewContent">
      <div class="piebox">
        <div class="date-selector-section">
          <div class="date-selector-container">
            <button class="date-nav-btn" id="prevDay">â€¹</button>
            <div class="date-display" id="dateDisplay">Today</div>
            <button class="date-nav-btn" id="nextDay">â€º</button>
            <input type="date" id="datePicker" class="date-picker">
          </div>
        </div>

        <div class="visualization-grid">
          <div class="stat-card">
            <div class="stat-value" id="todayTotal">0h 0m</div>
            <div class="stat-label" id="totalLabel">Total Time</div>
            <div class="last">
              <div class="stat-value" id="micro">0</div>
              <div class="stat-label" id="microLabel">Microflicks</div>
            </div>
          </div>
          <div class="visualization-section">
            <div class="chart-container pie-chart-container item2">
              <div class="chart-placeholder" id="pieChartPlaceholder">
                <div class="loading-spinner"></div>
                <div style="margin-top: 12px;">Loading pie chart...</div>
              </div>
              <canvas id="pieChart" style="display: none;"></canvas>
            </div>
          </div>
          <div class="stat-card">
            <!-- This will be changed to coins earned -->
            <div class="stat-value" id="sitesVisited">0</div>
            <div class="stat-label">Sites Visited</div>
            <div class="last">
              <div class="stat-value" id="productiveTime">0h 0m</div>
              <div class="stat-label" id="productiveTimeLabel">Productive Time</div>
            </div>
          </div>
        </div>
      </div>

      <div class="visualization-section">
        <div class="section-title timeline">Daily Timeline</div>
        <div class="chart-container schedule-container">
          <div class="chart-placeholder" id="schedulePlaceholder">
            <div class="loading-spinner"></div>
            <div style="margin-top: 12px;">Loading timeline...</div>
          </div>
          <div id="blockSchedule" style="display: none;"></div>
        </div>
      </div>
    </div>
    
    <!-- Shown when in settings mode -->
    <div id="settingsContent" style="display: none;">
        <!-- Blocking Rules Section -->
        <div class="blocking-section" id="blockingRulesSection">
          <div class="section-title">Blocking Rules</div>
          <div class="blocking-container">
            <div id="blockingStatusMessage" class="form-help" style="margin-bottom:8px;color:#667eea;display:none;"></div>
            <div class="form-help" style="margin-bottom:12px;color:#dc2626;">
              <strong>Note:</strong> After adding or changing a blocking rule, close and reopen your browser to ensure the new rules are fully applied to all tabs.
            </div>
            <!-- Add Website Form -->
            <div class="form-group">
              <label class="form-label" for="newBlockedSite">Add Website to Block</label>
              <div style="display: flex; gap: 8px; align-items: flex-end;">
                <input type="text" class="form-input" id="newBlockedSite" placeholder="Enter domain (e.g., facebook.com)" style="flex: 1;">
                <div class="button-group">
                  <button type="button" id="addBlockedSite" class="btn btn-primary">Add</button>
                </div>
              </div>
              <div class="form-help">Enter a website domain to add to your blocking list.</div>
            </div>
            <!-- Redirect URL Setting -->
            <div class="form-group">
              <label class="form-label" for="redirectUrl">Redirect URL (Optional)</label>
              <input type="url" class="form-input" id="redirectUrl" placeholder="https://example.com/focus-page">
              <div class="form-help">Custom page to redirect to when blocked sites are accessed. Leave empty for default block page.</div>
            </div>
            <!-- Blocked Sites List -->
            <div class="form-group">
              <label class="form-label">Blocked Websites List</label>
              <div id="blockedSitesList" class="blocked-sites-list">
                <div class="empty-state" id="emptyState">
                  <span style="color: #94a3b8; font-style: italic;">No websites blocked yet. Add a website above to get started.</span>
                </div>
              </div>
            </div>
            <!-- Blocking Schedule -->
            <div class="form-group">
              <label class="form-label"><span>ðŸ“…</span> Blocking Schedule (not working)</label>
              <div class="form-help" style="margin-bottom: 16px;">Set specific days and times when websites should be blocked. Leave empty to block 24/7.</div>
              <div id="scheduleContainer" class="schedule-container">
                <div class="schedule-controls">
                  <button type="button" id="addScheduleRule" class="btn btn-secondary" style="margin-bottom: 16px;">+ Add Schedule Rule</button>
                </div>
                <div id="scheduleRulesList" class="schedule-rules-list">
                  <div class="empty-state" id="scheduleEmptyState">
                    <span style="color: #94a3b8; font-style: italic;">No schedule rules set. Blocking will be active 24/7.</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Password Section -->
        <div class="blocking-section" id="passwordSection">
          <div class="section-title">Password</div>
          <div class="blocking-container">
            <!-- Password Protection Setting -->
            <div class="form-group">
              <label class="form-label" for="blockingPassword">Password Protection (Optional)</label>
              <div style="display: flex; gap: 8px; align-items: flex-end;">
                <input type="password" class="form-input" id="blockingPassword" placeholder="Enter password to protect blocking settings" style="flex: 1;">
                <button type="button" id="savePassword" class="btn btn-secondary">Save</button>
              </div>
              <div class="form-help">
                Set a password to prevent websites from being unblocked or removed without authorization. <br><strong>Note:</strong> If a password is already set, you must enter the current password before making changes.<br>Leave empty and save to disable password protection.
              </div>
            </div>
          </div>
        </div>

      <!-- Extension Settings Panel -->
      <div class="settings-panel active" id="settingsPanel">
        <div class="section-title">
          Extension Settings
        </div>
        <div class="form-group">
          <label class="form-label">Developer Tools</label>
          <button type="button" id="resetSession" class="btn btn-secondary" style="width: 100%;">
            Clear All Browsing Data
          </button>
          <div class="form-help">
            Clear all time tracking data for all days. This action cannot be undone.
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="overview.js"></script>
</body>
</html>
